# Исправления проблем импорта

## Исправленные проблемы

### 1. Ошибка "Node not found" при импорте

**Проблема:** При импорте слайдов с конкретным node-id из Figma URL возникала ошибка "Node 14006-380 not found", что приводило к долгой загрузке и неудачному импорту.

**Причина:** В Figma URL node-id записывается с дефисом (например: `14006-380`), но API Figma ожидает node-id с двоеточием (например: `14006:380`). Конвертация была реализована неконсистентно в разных частях кода.

**Решение:** Исправлена конвертация node-id в трех местах:

1. **app/api/slides/import/route.ts**:
   ```typescript
   const nodeId = nodeIdMatch[1].replace(/-/g, ':'); // Заменяем все дефисы на двоеточия
   ```

2. **lib/figma.ts** в функции `parseFigmaUrl`:
   ```typescript
   nodeId: match[2]?.replace(/%3A/g, ':').replace(/-/g, ':'), // Обрабатываем как URL-encoded, так и обычные дефисы
   ```

3. **lib/figma.ts** в функции `extractSlidesFromFigma`:
   ```typescript
   const apiNodeId = nodeId.replace(/%3A/g, ':').replace(/-/g, ':'); // Консистентная обработка с parseFigmaUrl
   ```

### 2. Слишком большое превью слайдов

**Проблема:** Превью слайдов в ImportModal было слишком большим, что делало работу с ним неудобной.

**Решение:** Уменьшены размеры карточек превью:

- **Сетка:** Изменена с `grid-cols-1 sm:grid-cols-2 lg:grid-cols-3` на `grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5`
- **Отступы:** Уменьшены с `gap-6` до `gap-4`
- **Высота:** Уменьшена с `max-h-[500px]` до `max-h-[400px]`
- **Padding карточек:** Уменьшен с `p-3 space-y-2` до `p-2 space-y-1`
- **Размер текста:** Уменьшен с `text-sm` до `text-xs`
- **Размер иконок:** Уменьшен с `w-5 h-5` до `w-4 h-4`
- **Placeholder изображений:** Изменен с 400x300 на 300x200
- **Поля селекта:** Уменьшены с `px-2 py-1` до `px-1 py-0.5`

### 3. Улучшения компактности

**Дополнительные улучшения:**
- Убран вывод типа фрейма (`{frame.type}`) для экономии места
- Убраны иконки в подкатегориях селекта для компактности
- Добавлен `pr-1` к названию для предотвращения наложения с иконкой выбора

## Результат

Теперь импорт работает корректно:
1. ✅ Правильная конвертация node-id из URL
2. ✅ Быстрый и надежный импорт слайдов
3. ✅ Компактное и удобное превью
4. ✅ Больше слайдов помещается на экране одновременно
5. ✅ Лучший пользовательский опыт при выборе категорий

## Тестирование

Для проверки исправлений:
1. Скопируйте Figma URL с node-id (например, с параметром `node-id=14006-380`)
2. Откройте ImportModal
3. Вставьте URL и нажмите "Preview Slides"
4. Убедитесь, что превью загружается быстро и отображается компактно
5. Выберите категории для слайдов
6. Импортируйте слайды - процесс должен завершиться успешно 