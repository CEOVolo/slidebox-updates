# üìã –ß–µ–∫–ª–∏—Å—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ú–∏–≥—Ä–∞—Ü–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö dev ‚Üí prod
npm run data:migrate-dev-to-prod

# –ó–∞—Å–µ–≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤ —Ç–µ–∫—É—â—É—é –ë–î
npm run data:seed-metadata

# –ó–∞—Å–µ–≤ –≤ production
npm run data:seed-prod

# –ü–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
npm run data:full-sync
```

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### 1. –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–∞–Ω–Ω—ã—Ö (static_metadata, core_metadata, business_metadata, content_data, user_data, relationship_data)
- [ ] –í—ã—è–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥—Ä—É–≥–∏—Ö —Ç–∞–±–ª–∏—Ü
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö (–Ω—É–∂–Ω–∞ –ª–∏ –±–∞—Ç—á–µ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- [ ] –ü–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –≤ `config/migration-config.ts`
- [ ] –£–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –ø–æ—Ä—è–¥–æ–∫
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- [ ] –í—ã–±—Ä–∞—Ç—å —Ç–∏–ø –æ–±—Ä–∞–±–æ—Ç–∫–∏ (normal, hierarchical, batch, custom)
- [ ] –ò—Å–∫–ª—é—á–∏—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏

### 3. –°–∫—Ä–∏–ø—Ç –∑–∞—Å–µ–≤–∞

- [ ] –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç `scripts/seed-{table-name}.ts`
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `upsert` –≤–º–µ—Å—Ç–æ `create` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –æ—Ç–¥–µ–ª—å–Ω–æ

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

- [ ] –û–±–Ω–æ–≤–∏—Ç—å mapping –≤ `scripts/data-seeding-manager.ts`
- [ ] –î–æ–±–∞–≤–∏—Ç—å npm –∫–æ–º–∞–Ω–¥—É –≤ `package.json` (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

### 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- [ ] –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫: `npm run migrate:universal -- --dry-run`
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞—Å–µ–≤–∞: `npm run seed:managed -- --tables new_table`
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π: `node -e "console.log(require('./config/migration-config').validateDependencies())"`
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ dev –æ–∫—Ä—É–∂–µ–Ω–∏–∏

### 6. –î–µ–ø–ª–æ–π

- [ ] –°–æ–∑–¥–∞—Ç—å backup: `pg_dump > backup.sql`
- [ ] –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∫–æ–¥
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é/–∑–∞—Å–µ–≤
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã: `npm run verify:metadata`

## üìã –®–∞–±–ª–æ–Ω—ã

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã

```typescript
{
  tableName: 'tableName',
  displayName: '–û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è',
  icon: 'üìù',
  dependencies: ['dependency1', 'dependency2'], // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
  specialHandling: 'batch', // 'normal' | 'hierarchical' | 'batch' | 'custom'
  batchSize: 100, // –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü
  excludeFields: ['sensitiveField1', 'sensitiveField2'],
  transformations: {
    email: (email: string) => email.toLowerCase(),
    // –¥—Ä—É–≥–∏–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏
  }
}
```

### –°–∫—Ä–∏–ø—Ç –∑–∞—Å–µ–≤–∞

```typescript
import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

export async function seedTableName() {
  console.log('üå± –ó–∞—Å–µ–≤–∞–µ–º TableName...');
  
  const data = [
    // –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ
  ];

  for (const item of data) {
    await prisma.tableName.upsert({
      where: { uniqueField: item.uniqueField },
      update: item,
      create: item
    });
  }
  
  console.log(`‚úÖ –ó–∞—Å–µ—è–Ω–æ ${data.length} –∑–∞–ø–∏—Å–µ–π`);
}

if (require.main === module) {
  seedTableName()
    .catch(console.error)
    .finally(() => prisma.$disconnect());
}
```

## ‚ö° –ß–∞—Å—Ç—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞

```bash
# 1. –î–æ–±–∞–≤–∏—Ç—å –≤ static_metadata –∏–ª–∏ core_metadata
# 2. –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –∑–∞—Å–µ–≤–∞
# 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
npm run seed:managed -- --tables new_reference --dry-run
# 4. –ó–∞—Å–µ—è—Ç—å
npm run seed:managed -- --tables new_reference
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–æ–ª—å—à–æ–π —Ç–∞–±–ª–∏—Ü—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞

```bash
# 1. –î–æ–±–∞–≤–∏—Ç—å –≤ content_data —Å specialHandling: 'batch'
# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–∏–π batchSize
# 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–∞—Ç—á–∞–º–∏
npm run migrate:universal -- --tables large_table --batch-size 50 --dry-run
# 4. –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å
npm run migrate:universal -- --tables large_table --batch-size 50
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑–µ–π (many-to-many)

```bash
# 1. –î–æ–±–∞–≤–∏—Ç—å –≤ relationship_data
# 2. –£–∫–∞–∑–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–≤—è–∑—ã–≤–∞–µ–º—ã—Ö —Ç–∞–±–ª–∏—Ü
# 3. –ó–∞—Å–µ—è—Ç—å –ø–æ—Å–ª–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
npm run seed:managed -- --categories static_metadata,core_metadata,business_metadata
npm run seed:managed -- --categories relationship_data
```

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

```bash
# –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
node -e "console.log(require('./config/migration-config').validateDependencies())"

# –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫
npm run migrate:universal -- --dry-run

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤ –∑–∞—Å–µ–≤–∞
npm run seed:managed -- --categories static_metadata --skip-existing
```

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

```bash
# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
npm run verify:metadata

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
docker-compose exec postgres psql -U user -d db -c "SELECT COUNT(*) FROM table_name;"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–µ–π
docker-compose exec postgres psql -U user -d db -c "SELECT COUNT(*) FROM slide_tags;"
```

## üö® Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: Foreign key constraint

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ —Ç–∞–±–ª–∏—Ü—ã –º–∏–≥—Ä–∏—Ä—É—é—Ç—Å—è –ø–µ—Ä–≤—ã–º–∏

### –ü—Ä–æ–±–ª–µ–º–∞: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `upsert` –≤–º–µ—Å—Ç–æ `create`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª—è –≤ `where` —É—Å–ª–æ–≤–∏–∏

### –ü—Ä–æ–±–ª–µ–º–∞: Timeout –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ:**
- –£–º–µ–Ω—å—à–∏—Ç—å `batchSize`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `specialHandling: 'batch'`
- –£–≤–µ–ª–∏—á–∏—Ç—å timeout —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: –°–∫—Ä–∏–ø—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
- –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –∑–∞—Å–µ–≤–∞
- –û–±–Ω–æ–≤–∏—Ç—å mapping –≤ `data-seeding-manager.ts`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É—Ç—å –∫ —Å–∫—Ä–∏–ø—Ç—É

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –±–∞—Ç—á–µ–π

- **–ú–∞–ª—ã–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏** (< 100 –∑–∞–ø–∏—Å–µ–π): –æ–±—ã—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- **–°—Ä–µ–¥–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã** (100-1000 –∑–∞–ø–∏—Å–µ–π): batch 50-100
- **–ë–æ–ª—å—à–∏–µ —Ç–∞–±–ª–∏—Ü—ã** (> 1000 –∑–∞–ø–∏—Å–µ–π): batch 20-50
- **–û—á–µ–Ω—å –±–æ–ª—å—à–∏–µ** (> 10000): batch 10-20 + –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

```bash
# –ó–∞—Å–µ–≤ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –ø–æ—Ç–æ–∫–æ–≤
npm run seed:managed -- --parallel --max-concurrency 3

# –ë–∞—Ç—á–µ–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è
npm run migrate:universal -- --batch-size 25

# –ß–∞—Å—Ç–∏—á–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
npm run migrate:universal -- --categories static_metadata --dry-run
``` 